package game;

import javax.swing.*;
import java.awt.event.*;

public class Main {
	private int points = 0;
	private int clines = 0;
	private Timer timer;
	private KeyListener controls;
	private boolean gameOn = true;
	private boolean unstacked = true;

	private Board b = new Board(gameOn, unstacked);
	private GameInterface gi = new GameInterface(b.showBoard());

	public Main() {
		JFrame fuckthis=new JFrame();
		JPanel imeanreally=new JPanel();
		fuckthis.add(imeanreally);
		imeanreally.addKeyListener(controls);
		gi.display();
		timer = new Timer(1000, new ActionListener() {
			public void actionPerformed(ActionEvent evt) {
				System.out.println("LOOK DOWN");
				//unstacked = b.move(Direction.DOWN);
				if(!unstacked)
					cycle();
				//gi.display();
			};
		});
		controls=new KeyListener(){

			@Override
			public void keyPressed(KeyEvent arg0) {
				System.out.println("something is happening, I guess");
				if(KeyEvent.VK_DOWN==arg0.getKeyCode())
					b.move(Direction.DOWN);
				else if(KeyEvent.VK_UP==arg0.getKeyCode())
					b.move(Direction.UP);
				else if(arg0.getKeyCode()==KeyEvent.VK_RIGHT)
					b.move(Direction.RIGHT);
				else if(arg0.getKeyCode()==KeyEvent.VK_LEFT)
					b.move(Direction.LEFT);
				else {}

					
			}

			@Override
			public void keyReleased(KeyEvent arg0) {
					// TODO Auto-generated method stub
				
			}

			@Override
			public void keyTyped(KeyEvent arg0) {
				char c=arg0.getKeyChar();
				if (c=='z')
					b.move(Direction.CCW);
				else if(c=='x')
					b.move(Direction.CW);
				else{
					System.out.println("WRONG KEY, FUCKTARD");
				}
				
			}};
		
		/* This will go in a keylistener/binding
		
		Direction input = gi.input();
		unstacked = b.move(input);
		gi.display();
		
		*/
		timer.setDelay(1000 - (clines / 10) * 50);

		timer.start();
		cycle();
		unstacked = true;
		while(gameOn){}

		// }
		System.out.println("wut");

		endgame();
	
	}

	private void endgame() {
		System.out.println("YOU LOSE");
		timer.stop();

	}

	public enum Direction {
		UP, DOWN, LEFT, RIGHT, CW, CCW, NONE
	}

	public void cycle() {
		System.out.println("Cycling");

		timer.setDelay(1000 - (clines / 10) * 50);
		b.clear();
		gameOn = b.endcheck();
		if(gameOn)
		b.spawn();
		

			

		}

	

}
